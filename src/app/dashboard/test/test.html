<div class="w-full h-screen p-10 flex flex-col gap-10 overflow-x-hidden">
  <!--  ناوبار بالا-->
  <app-dashnav title="آزمون های روان شناختی"></app-dashnav>
  <div class="w-full shadow-[0_0_20px_0_rgba(0,0,0,0.07)] items-center py-5 px-10 md:px-20 rounded-xl flex md:hidden flex-row justify-around">
    <p>تعداد سکه های شما: </p>
    <p>{{localStorage.getItem('coin')}}</p>
  </div>

  <div class="flex flex-col md:flex-row w-full gap-10">
    <!--    باکس کارت های آزمون ها-->
    <div class="grid grid-cols-1 md:grid-cols-2 p-5 w-full md:w-3/4 gap-10 overflow-x-auto">
      @if (!isLoading) {
        @for (item of testlist; track item) {
          <div
            class="shadow-[0_0_20px_0_rgba(0,0,0,0.07)] h-96 hover:bg-gray-50 transition-all duration-300 p-10 rounded-xl w-full flex flex-col gap-5 items-center justify-between"
          >
            <div class="flex flex-col gap-5 items-center">
              <p class="text-3xl font-black">{{ item.testName }}</p>
              <p class="text-sm font-light text-gray-500 text-justify">
                {{ item.introduction }}
              </p>
            </div>

            <div class="flex flex-col gap-5 w-full">
              <div class="flex flex-row w-full justify-around">
                <div class="flex flex-row gap-3 invert-50 h-5 items-center">
                  <img src="svg/Question%20Circle.svg" />
                  <p>{{ item.questionsCount }}</p>
                </div>

                <div class="flex flex-row gap-3 invert-50 h-5 items-center">
                  <img src="svg/Alarm.svg" />
                  <p>{{ item.suggestedDuration }}</p>
                </div>
              </div>

              <div
                (click)="
                  this.router.navigateByUrl(
                    '/dashboard/test/teststart/' + item.testName
                  )
                "
                class="flex flex-row gap-3 items-center font-black w-full bg-[#14AE5C] shadow-[0_0_20px_0_rgba(0,0,0,0.07)] text-2xl cursor-pointer hover:scale-102 hover:bg-[#14A35C] transition-all duration-300 text-white p-3 rounded-lg justify-center"
              >
                <p>{{ item.fee }}</p>
                <img
                  src="png/golden-coin-money-dollar-icon_24877-83458%201.png"
                />
              </div>
            </div>
          </div>
        }
      } @else {
        <p-skeleton width="100%" height="400px"></p-skeleton>
        <p-skeleton width="100%" height="400px"></p-skeleton>
      }
    </div>

    <div class="flex flex-col m-0 w-full md:w-1/4 gap-10 mb-10">
      <!--     ********************** باکس تاریخچه آزمون ها************************-->
      <div
        class="shadow-[0_0_20px_0_rgba(0,0,0,0.07)] p-5 flex flex-col rounded-xl w-full"
      >
        <div class="flex flex-row items-center justify-between">
          <p class="font-black">آخرین آزمون ها</p>
          <p
            (click)="router.navigateByUrl('/dashboard/test/testhistory')"
            class="text-center text-gray-400 text-xs cursor-pointer"
          >
            مشاهده همه
          </p>
        </div>

        @if (isLoading) {
          <div class="flex flex-col gap-5 py-5 w-full">
            <div class="flex flex-row justify-between gap-3 w-full">
              <p-skeleton width="80%" height="60px"></p-skeleton>
              <div class="flex flex-col w-full gap-3">
                <p-skeleton width="80%" height="25px"></p-skeleton>
                <p-skeleton width="80%" height="20px"></p-skeleton>
              </div>
            </div>

            <p-skeleton height="2px" width="100%"></p-skeleton>

            <div class="flex flex-row justify-between gap-3 w-full">
              <p-skeleton width="80%" height="60px"></p-skeleton>
              <div class="flex flex-col w-full gap-3">
                <p-skeleton width="80%" height="25px"></p-skeleton>
                <p-skeleton width="80%" height="20px"></p-skeleton>
              </div>
            </div>

            <p-skeleton height="2px" width="100%"></p-skeleton>

            <div class="flex flex-row justify-between gap-3 w-full">
              <p-skeleton width="80%" height="60px"></p-skeleton>
              <div class="flex flex-col w-full gap-3">
                <p-skeleton width="80%" height="25px"></p-skeleton>
                <p-skeleton width="80%" height="20px"></p-skeleton>
              </div>
            </div>
          </div>
        } @else {
          <!--          تک تک آزمون ها-->
          @for (history of testhistory; track history.id) {
            <div
              class="flex flex-row justify-between items-center pl-5 border-b-2 border-gray-200"
            >
              <p
                (click)="isModalOpen = true; selectedItem = history"
                class="text-xl w-1/2 py-4 cursor-pointer hover:bg-gradient-to-bl hover:from-[#14ae5c] hover:to-[#14a15c] transition-all duration-300 hover:scale-102 rounded-md text-center bg-[#14ae5c] text-white"
              >
                {{ history.testName }}
              </p>

              <div class="flex flex-col items-center gap-3 py-4 justify-around">
                <p class="text-sm text-gray-600 text-center">
                  {{ history.result }}
                </p>
                <p class="text-xs text-gray-400">{{ history.date }}</p>
              </div>
            </div>
          }
        }
      </div>

      <!--        باکس آمار-->

      <div
        class="shadow-[0_0_20px_0_rgba(0,0,0,0.07)] p-5 gap-5 flex flex-col rounded-xl w-full"
      >
        <div class="flex flex-row items-center justify-start">
          <p class="font-black">آمار آزمون ها</p>
          <p
            (click)="router.navigateByUrl('/dashboard/test/testhistory')"
            class="text-center text-gray-400 text-xs cursor-pointer"
          ></p>
        </div>

        @if (isLoading) {
          <div class="flex flex-col gap-5 py-5 w-full">
            <div class="flex flex-row justify-between gap-3 w-full">
              <p-skeleton width="80%" height="60px"></p-skeleton>
              <div class="flex flex-col w-full gap-3">
                <p-skeleton width="80%" height="25px"></p-skeleton>
                <p-skeleton width="80%" height="20px"></p-skeleton>
              </div>
            </div>

            <p-skeleton height="2px" width="100%"></p-skeleton>

            <div class="flex flex-row justify-between gap-3 w-full">
              <p-skeleton width="80%" height="60px"></p-skeleton>
              <div class="flex flex-col w-full gap-3">
                <p-skeleton width="80%" height="25px"></p-skeleton>
                <p-skeleton width="80%" height="20px"></p-skeleton>
              </div>
            </div>

            <p-skeleton height="2px" width="100%"></p-skeleton>

            <div class="flex flex-row justify-between gap-3 w-full">
              <p-skeleton width="80%" height="60px"></p-skeleton>
              <div class="flex flex-col w-full gap-3">
                <p-skeleton width="80%" height="25px"></p-skeleton>
                <p-skeleton width="80%" height="20px"></p-skeleton>
              </div>
            </div>
          </div>
        } @else {
          <!--          تک تک آمار ها-->
          <div class="flex flex-row justify-between items-center gap-5">
            <p class="text-gray-500 text-sm">آزمون های فعال</p>
            <p class="text-2xl font-black text-[#14AE5C]">{{ testlist.length }}</p>
          </div>

          <div class="flex flex-row justify-between items-center gap-5">
            <p class="text-gray-500 text-sm">آزمون های انجام شده</p>
            <p class="text-2xl font-black text-[#14AE5C]">{{ history.length+1 }}</p>
          </div>
        }
      </div>
    </div>
  </div>
</div>

<div>
  <app-pupup
    [show]="isModalOpen"
    [item]="selectedItem"
    (close)="isModalOpen = false"
  ></app-pupup>


</div>

